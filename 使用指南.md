# 俄罗斯方块 - 新功能使用指南

## 🎮 三大新功能已上线！

### 1. 图形化设置菜单 ⚙️

**如何打开：** 游戏中按 **ESC键**

**包含设置：**
- ✅ 音效开关
- ✅ 背景音乐开关
- ✅ 音乐音量滑块（0-100%）
- ✅ 音效音量滑块（0-100%）
- ✅ 幽灵方块显示
- ✅ 霓虹模式切换

**操作方式：**
- 点击开关项即可切换
- 点击音量滑块调整音量
- 按 **K键** 进入键位绑定
- 按 **ESC键** 关闭设置

**视觉风格：**
- 紫色主题边框
- 半透明遮罩
- 滑动开关动画

---

### 2. 自定义键位系统 ⌨️

**如何进入：**
1. 按 **ESC键** 打开设置
2. 按 **K键** 进入键位绑定面板

**可自定义的操作：**
```
游戏控制：
- 左移   ← （默认左箭头）
- 右移   → （默认右箭头）
- 旋转   ↑ （默认上箭头）
- 软降   ↓ （默认下箭头）
- 硬降   Space（默认空格）

系统功能：
- 暂停   P（默认P键）
- 霓虹   N（默认N键）
- 静音   M（默认M键）
- 重来   R（默认R键）
- 统计   Tab（默认Tab键）
- 成就   H（默认H键）
```

**绑定新按键：**
1. 点击要修改的键位项
2. 按下新的按键
3. 自动保存并生效

**取消绑定：**
- 按 **ESC键** 取消

**视觉反馈：**
- 正在绑定的项会高亮显示（金色边框）
- 按键名称实时更新
- 持久化保存（tetris_keybinds.json）

---

### 3. 背景音乐 🎵

**特点：**
- 8秒循环旋律
- C大调电子游戏风格
- 和弦效果（主音+三度+五度）
- 低音贝斯
- 淡入淡出包络

**控制方式：**
- 在设置菜单中开关
- 音量独立调节（不影响音效）
- 游戏开始自动播放

**音量设置：**
- 音乐音量：0-100%
- 音效音量：0-100%
- 两者独立控制

---

## 🎯 快捷键总览

| 按键 | 功能 | 说明 |
|------|------|------|
| **ESC** | 设置菜单 | 打开/关闭设置 |
| **K** | 键位绑定 | 在设置中进入键位绑定 |
| **Tab** | 统计面板 | 查看详细统计 |
| **H** | 成就面板 | 查看成就进度 |
| **P** | 暂停游戏 | 暂停/继续 |
| **N** | 霓虹模式 | 切换炫酷特效 |
| **M** | 静音 | 切换音效 |
| **R** | 重新开始 | 重置游戏 |
| **Q** | 退出游戏 | 关闭程序 |
| **↑** | 旋转 | 顺时针旋转 |
| **← →** | 左右移动 | 移动方块 |
| **↓** | 软降 | 加速下落 |
| **Space** | 硬降 | 瞬间落地 |

---

## 💾 数据文件

游戏会自动创建以下配置文件：

```
tetris_settings.json      # 游戏设置（音量、模式等）
tetris_keybinds.json      # 键位绑定配置
tetris_statistics.json    # 统计数据
tetris_achievements.json  # 成就解锁记录
tetris_leaderboard.json   # 排行榜数据
```

---

## 🔧 技术亮点

### 模块化设计
- `SettingsManager` - 设置管理器
- `KeyBindManager` - 键位管理器
- `SoundManager` - 音效管理器（增强版）

### 用户体验
- 图形化界面，直观易用
- 半透明遮罩，不遮挡游戏
- 实时反馈，即时生效
- 持久化保存，下次启动自动加载

### 音频系统
- 程序生成音乐（无需外部文件）
- 和弦+贝斯丰富层次
- 音量独立控制
- 无限循环播放

---

## 🎨 界面主题

不同面板使用不同颜色主题：
- 设置菜单：**紫色** (150, 150, 255)
- 键位绑定：**金色** (255, 215, 0)
- 统计面板：**蓝色** (100, 200, 255)
- 成就面板：**金色** (255, 215, 0)

---

## ⚡ 使用流程示例

### 调整音量流程
1. 游戏中按 **ESC** 打开设置
2. 点击"音效"或"背景音乐"开关
3. 查看音量滑块显示当前音量
4. （未来可拖动滑块调整）
5. 按 **ESC** 返回游戏

### 自定义键位流程
1. 游戏中按 **ESC** 打开设置
2. 按 **K** 进入键位绑定
3. 点击"硬降"项（显示金色高亮）
4. 按下新按键（如Enter键）
5. 立即生效，自动保存
6. 按 **ESC** 返回设置

---

## 🐛 常见问题

**Q: 背景音乐不播放？**
- 确保在设置中开启了"背景音乐"开关
- 检查音乐音量是否为0

**Q: 键位绑定不生效？**
- 确认按键没有被其他功能占用
- 查看tetris_keybinds.json文件是否存在

**Q: 设置没有保存？**
- 检查文件写入权限
- 确认json文件未损坏

---

## 🚀 未来计划

- [ ] 鼠标拖动音量滑块
- [ ] 更多主题皮肤
- [ ] 更多背景音乐风格
- [ ] 设置重置功能
- [ ] 键位预设方案（经典、专业等）
- [ ] 手柄/控制器支持

---

**版本：** Enhanced v3.0
**更新时间：** 2025-01-12
**开发状态：** ✅ 完成并测试
